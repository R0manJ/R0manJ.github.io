<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh_cn">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="R0hman の 实验室">
<meta property="og:url" content="http://github.com/r0manj/page/2/index.html">
<meta property="og:site_name" content="R0hman の 实验室">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Rohman.Zhu">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://github.com/r0manj/page/2/"/>





  <title>R0hman の 实验室</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh_cn">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
	<a href="https://github.com/r0manj" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">R0hman の 实验室</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-list"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            Schedule
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/04/19/Vmware-Horizon-Agent-%E9%9D%99%E9%BB%98%E5%AE%89%E8%A3%85%E5%AE%9E%E4%BE%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/19/Vmware-Horizon-Agent-%E9%9D%99%E9%BB%98%E5%AE%89%E8%A3%85%E5%AE%9E%E4%BE%8B/" itemprop="url">Vmware Horizon Agent 静默安装实例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-19T22:47:24+08:00">
                2020-04-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h1><p>在 Windows 下通过指令实现自动化安装 VMware Horizon View ，安装完后自动重启。</p>
<p>前提条件：</p>
<ol>
<li>Windows 已加域，并将View管理员添加至Administrator组。</li>
<li>使用View管理员登录，运行自动安装脚本。</li>
</ol>
<blockquote>
<p>使用View管理员登录安装View Agent，可以避免在脚本中输入管理员密码的明文信息，避免信息安全问题。</p>
</blockquote>
<p>需求：</p>
<ol>
<li>仅安装 核心 、 实时音频视频 、 VMware Horizon View Agent技术支持这三个部件。</li>
<li>脚本中不能出现明文密码，因此只能使用当前账户安装。</li>
<li>指定连接服务器。</li>
<li>安装完后需要输出日志，并且重启服务器。</li>
</ol>
<h1 id="脚本编写"><a href="#脚本编写" class="headerlink" title="脚本编写"></a>脚本编写</h1><p>从命令行静默安装 Horizon Agent 时，可以包含特定属性。您必须使用 PROPERTY=value 的格式，以便 Microsoft Windows Installer (MSI) 理解各属性和值。静默升级使用相同的安装命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\Vmware Horizon View Agent*.exe &#x2F;s &#x2F;v &quot;&#x2F;qn ADDLOCAL&#x3D;Core,RTAV,HelpDesk RDP_CHOICE&#x3D;0 VDM_SERVER_NAME&#x3D;xx.xx.xx.xx REBOOT&#x3D;Force&quot; &#x2F;l C:\View Agent.log</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>Horizon Agent 静默安装属性：<a href="https://docs.vmware.com/cn/VMware-Horizon-7/7.12/horizon-virtual-desktops/GUID-3096DA8B-034B-435B-877E-5D2B18672A95.html" target="_blank" rel="noopener">https://docs.vmware.com/cn/VMware-Horizon-7/7.12/horizon-virtual-desktops/GUID-3096DA8B-034B-435B-877E-5D2B18672A95.html</a></p>
<p>Microsoft Windows Installer 命令行选项： <a href="https://docs.vmware.com/cn/VMware-Horizon-7/7.12/horizon-virtual-desktops/GUID-1FD90D4D-0C7C-4E9E-B12D-974ABF15E398.html" target="_blank" rel="noopener">https://docs.vmware.com/cn/VMware-Horizon-7/7.12/horizon-virtual-desktops/GUID-1FD90D4D-0C7C-4E9E-B12D-974ABF15E398.html</a></p>
<p>MSI 指令：<a href="https://docs.microsoft.com/en-us/windows/win32/msi/reboot" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/msi/reboot</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/03/15/GIT-HEXO%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/15/GIT-HEXO%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/" itemprop="url">GIT+HEXO快速部署</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-15T21:56:34+08:00">
                2020-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><table>
<thead>
<tr>
<th align="center">Iten</th>
<th align="center">Detail</th>
</tr>
</thead>
<tbody><tr>
<td align="center">OS</td>
<td align="center">CentOS 7</td>
</tr>
<tr>
<td align="center">Kernel</td>
<td align="center">Linux 3.10.0-862.el7.x86_64</td>
</tr>
<tr>
<td align="center">Node version</td>
<td align="center">13.9.0</td>
</tr>
<tr>
<td align="center">npm version</td>
<td align="center">6.13.7</td>
</tr>
<tr>
<td align="center">hexo version</td>
<td align="center">4.2.0</td>
</tr>
<tr>
<td align="center">Git version</td>
<td align="center">1.8.3.1</td>
</tr>
</tbody></table>
<h1 id="一、安装与配置-git"><a href="#一、安装与配置-git" class="headerlink" title="一、安装与配置 git"></a>一、安装与配置 git</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install git-core -y</span><br><span class="line">git --version</span><br><span class="line"></span><br><span class="line">git --global user.name <span class="string">"r0manj"</span></span><br><span class="line">git --global user.email <span class="string">"zhur0ngjian@126.com"</span></span><br></pre></td></tr></table></figure>

<h1 id="二、安装-node-js"><a href="#二、安装-node-js" class="headerlink" title="二、安装 node.js"></a>二、安装 node.js</h1><p>使用yum安装只会安装到老版本，直接到官网下载最新的源码包，采用源码安装。</p>
<p>官网：<a href="http://nodejs.cn/download/" target="_blank" rel="noopener">http://nodejs.cn/download/</a><br>淘宝镜像：<a href="https://npm.taobao.org/mirrors/node/" target="_blank" rel="noopener">https://npm.taobao.org/mirrors/node/</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压安装包</span></span><br><span class="line">tar xvf node-v13.9.0-linux-x64.tar</span><br><span class="line"><span class="comment"># 将安装包拷贝到 /usr/local/node-13.9.0目录下。（略）</span></span><br><span class="line"><span class="comment"># 将bin目录的可执行文件添加到环境变量中</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"export PATH=<span class="variable">$PATH</span>:/usr/local/node-13.9.0/bin"</span> &gt;&gt; /etc/profile</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="comment"># 配置国内npm镜像源</span></span><br><span class="line">npm config <span class="built_in">set</span> registry http://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>

<h1 id="三、安装hexo"><a href="#三、安装hexo" class="headerlink" title="三、安装hexo"></a>三、安装hexo</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure>

<h1 id="四、创建GitHub代码仓库与初始化hexo博客"><a href="#四、创建GitHub代码仓库与初始化hexo博客" class="headerlink" title="四、创建GitHub代码仓库与初始化hexo博客"></a>四、创建GitHub代码仓库与初始化hexo博客</h1><p>GITHUB创建代码仓库（略）</p>
<p>创建空目录后执行初始化操作</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line"></span><br><span class="line">npm install --save hexo-deployer-git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成标签页和目录页</span></span><br><span class="line">hexo new page tags</span><br><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure>

<blockquote>
<p>需要在tags和categories的页面里添加属性，type:”tags” 、type:”categories”</p>
</blockquote>
<p>配置hexo的 _config.yml 文件，设置git的相关账号。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:R0manJ/R0manJ.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<h1 id="五、到GitHub上的仓库添加这台服务器的ssh-key"><a href="#五、到GitHub上的仓库添加这台服务器的ssh-key" class="headerlink" title="五、到GitHub上的仓库添加这台服务器的ssh-key"></a>五、到GitHub上的仓库添加这台服务器的ssh-key</h1><p>到仓库的setting界面，进入Deploy keys，点击 “Add deploy key”，将服务器的公钥添加进去。</p>
<h1 id="六、其他操作"><a href="#六、其他操作" class="headerlink" title="六、其他操作"></a>六、其他操作</h1><h2 id="配置samba服务"><a href="#配置samba服务" class="headerlink" title="配置samba服务"></a>配置samba服务</h2><p>可以部署samba服务将post文件夹共享出来。</p>
<h2 id="防火墙配置"><a href="#防火墙配置" class="headerlink" title="防火墙配置"></a>防火墙配置</h2><p>图省事就关闭了</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewal-cmd --state</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://www.cnblogs.com/huay/p/11266803.html" target="_blank" rel="noopener">https://www.cnblogs.com/huay/p/11266803.html</a></p>
<p><a href="https://blog.csdn.net/tian330726/article/details/80791388" target="_blank" rel="noopener">https://blog.csdn.net/tian330726/article/details/80791388</a></p>
<p>samba服务-1：<a href="https://blog.csdn.net/u013230234/article/details/81639801" target="_blank" rel="noopener">https://blog.csdn.net/u013230234/article/details/81639801</a></p>
<p>samba服务-2：<a href="https://blog.csdn.net/weixin_41078837/article/details/80570693" target="_blank" rel="noopener">https://blog.csdn.net/weixin_41078837/article/details/80570693</a></p>
<p>CentOS7防火墙操作相关：<a href="https://www.cnblogs.com/xxoome/p/7115614.html" target="_blank" rel="noopener">https://www.cnblogs.com/xxoome/p/7115614.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/03/15/AD%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%98%B2%E7%81%AB%E5%A2%99%E7%AB%AF%E5%8F%A3%E6%95%B4%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/15/AD%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%98%B2%E7%81%AB%E5%A2%99%E7%AB%AF%E5%8F%A3%E6%95%B4%E7%90%86/" itemprop="url">AD服务器防火墙端口整理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-15T20:46:00+08:00">
                2020-03-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Windows-Server/" itemprop="url" rel="index">
                    <span itemprop="name">Windows Server</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>If you are working on Active Directory environment and have domain joined systems that needs access to Active Directory that are on different or isolated networks separated by Firewall then you need to allow multiple Active Directory ports to pass through the Firewall. Below are the ports that I have validated and needs to be allowed for smooth member server / workstation and AD Communication, as well as for replication -</p>
<h1 id="端口列表"><a href="#端口列表" class="headerlink" title="端口列表"></a>端口列表</h1><table>
<thead>
<tr>
<th align="center">Port Description</th>
<th align="center">Port Details</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Kerberos</td>
<td align="center">TCP-88,UDP-88</td>
</tr>
<tr>
<td align="center">DNS</td>
<td align="center">TCP-53,UDP-53</td>
</tr>
<tr>
<td align="center">Global Catalog</td>
<td align="center">TCP-3268</td>
</tr>
<tr>
<td align="center">Global Catalog（Secure）</td>
<td align="center">TCP-3269</td>
</tr>
<tr>
<td align="center">LDAP</td>
<td align="center">TCP-389，UDP-389</td>
</tr>
<tr>
<td align="center">LDAP（Secure）</td>
<td align="center">TCP-636</td>
</tr>
<tr>
<td align="center">RPC/Replication</td>
<td align="center">TCP -135</td>
</tr>
<tr>
<td align="center">Time Service</td>
<td align="center">UDP-123</td>
</tr>
<tr>
<td align="center">Replication, User / Computer Authentication, Trusts and Group PolicyNetLogon, NetBIOS name ResolutionDFS , NetLogon</td>
<td align="center">TCP-49152<del>65535,UDP-49152</del>65535</td>
</tr>
<tr>
<td align="center">Kerberos Password Change</td>
<td align="center">TCP-464,UDP-464</td>
</tr>
<tr>
<td align="center">SMB(File Sharing)</td>
<td align="center">TCP-139,445</td>
</tr>
<tr>
<td align="center">DFSR</td>
<td align="center">TCP-5722</td>
</tr>
</tbody></table>
<h2 id="Replication"><a href="#Replication" class="headerlink" title="Replication"></a>Replication</h2><p>Replication uses the remote procedure call (RPC) transport. Replication connections can be created between any two domain controllers located in the same site. Connections can be made with multiple domain controllers to reduce replication latency.</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://gallery.technet.microsoft.com/Active-Directory-Firewall-bd21b246" target="_blank" rel="noopener">https://gallery.technet.microsoft.com/Active-Directory-Firewall-bd21b246</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/03/15/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/15/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-15T20:25:38+08:00">
                2020-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/03/08/Exchange-CU23%E5%8D%87%E7%BA%A7%E6%97%A5%E5%BF%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/08/Exchange-CU23%E5%8D%87%E7%BA%A7%E6%97%A5%E5%BF%97/" itemprop="url">Exchange CU23升级日志</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-08T15:28:40+08:00">
                2020-03-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最新的Exchange Server需要安装补丁KB4536988，而这个补丁需要升级至CU23才可安装，然而我们的服务器版本为CU21。因此，服务器需要做一遍升级操作才可安装补丁。</p>
<p>主要流程：</p>
<ol>
<li>安装 dot net 4.7.2</li>
<li>安装 CU23 </li>
<li>安装补丁 KB-4536988</li>
</ol>
<h1 id="前端服务器升级"><a href="#前端服务器升级" class="headerlink" title="前端服务器升级"></a>前端服务器升级</h1><p>升级步骤：</p>
<table>
<thead>
<tr>
<th align="center">步骤</th>
<th align="center">任务</th>
<th align="left">详情</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">备份OWA自定义文件</td>
<td align="left">Exchange Server\V15\Frontend\HttpProxy\版本号\themes</td>
<td align="center">CAS 前端服务器</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">备份OWA自定义文件</td>
<td align="left">Exchange Server\V15\Frontend\HttpProxy\OWA\Auth\logon.aspx</td>
<td align="center">CAS 前端服务器</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">安装 dot Net 4.7.2</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">安装CU23</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">安装KB-4536988</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">验证测试</td>
<td align="left">见前端测试流程</td>
<td align="center"></td>
</tr>
</tbody></table>
<blockquote>
<p>为了避免出错，可以管理员身份运行安装包，可以使用 CMD（以管理员身份运行）。</p>
</blockquote>
<p>测试流程：</p>
<ol>
<li>修改hosts文件，将邮件服务器域名解析指向目标前端服务器；</li>
<li>测试 OWA 的邮件收发情况（内网、外网均测试一下）</li>
<li>新建用户邮件 profile 文件 ，使用新profile文件进行邮件收发测试</li>
</ol>
<h1 id="后端服务器升级"><a href="#后端服务器升级" class="headerlink" title="后端服务器升级"></a>后端服务器升级</h1><table>
<thead>
<tr>
<th align="center">步骤</th>
<th align="center">任务</th>
<th align="left">详情</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">备份Web.config文件</td>
<td align="left">Exchange Server\Bin\EdgeTransport.exe.config</td>
<td align="center">后端服务器</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">将DAG中的邮箱服务器切换到维护模式</td>
<td align="left">见下列操作步骤</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">安装 dot Net 4.7.2</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">安装CU23</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">安装KB-4536988</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">将邮箱服务器退出维护模式</td>
<td align="left">见下列操作步骤</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">检查服务</td>
<td align="left">见下列操作步骤</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>进入维护模式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># 1. 定义本机主机名变量</span><br><span class="line">$Computer &#x3D; $ENV:ComputerName</span><br><span class="line"></span><br><span class="line"># 2. 排空邮箱服务器上的所有传送队列的活动邮件，同时传输这些邮件到另外一台服务器上。</span><br><span class="line">Redirect-Message -Server $Computer -Target [DAG的伙伴服务器FQDN名]</span><br><span class="line"></span><br><span class="line"># 3. 传输组件设置维护模式</span><br><span class="line">Set-ServerComponentState $Computer -Component HubTransport -State Draining -Requester Maintenance</span><br><span class="line"></span><br><span class="line"># 4. 重启Exchange传输服务</span><br><span class="line">Restart-Service MSExchangeTransport</span><br><span class="line"></span><br><span class="line"># 5. 暂停此群集节点</span><br><span class="line">Suspend-ClusterNode $Computer</span><br><span class="line"></span><br><span class="line"># 6. 设置迁移活动数据库不能回到当前数据库</span><br><span class="line">Set-MailboxServer $Computer -DatabaseCopyActivationDisabledAndMoveNow $True</span><br><span class="line"></span><br><span class="line"># 7. 设置自动切换数据库策略为阻止</span><br><span class="line">Set-MailboxServer $Computer -DatabaseCopyAutoActivationPolicy Blocked</span><br><span class="line"></span><br><span class="line"># 8. 将服务器设置到维护模式</span><br><span class="line">Set-ServerComponentState $Computer -Component ServerWideOffline -State Inactive -Requester Maintenance</span><br><span class="line"></span><br><span class="line"># 9. 查询所有服务器状态，所有组件必须为 “inactive” 状态 。（除了Monitoring 和 RecoveryActionsEnabled）</span><br><span class="line">Get-ServerComponentState $Computer | ft Component,State -Autosize</span><br></pre></td></tr></table></figure>

<p>退出维护模式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 1. 定义本机主机名变量</span><br><span class="line">$Computer &#x3D; $ENV:ComputerName</span><br><span class="line"></span><br><span class="line"># 2. 恢复传输组件状态</span><br><span class="line">Set-ServerComponentState $Computer -Component ServerWideOffline -State Active -Requester Maintenance</span><br><span class="line"></span><br><span class="line"># 3. 恢复此群集节点</span><br><span class="line">Resume-ClusterNode $Computer</span><br><span class="line"></span><br><span class="line"># 4. 手动切换数据库状态</span><br><span class="line">Set-MailboxServer $Computer -DatabaseCopyActivationDisabledAndMoveNow $False</span><br><span class="line"></span><br><span class="line"># 5. 设置自动切换数据库策略为不受限制</span><br><span class="line">Set-MailboxServer $Computer -DatabaseCopyAutoActivationPolicy Unrestricted</span><br><span class="line"></span><br><span class="line"># 6. 传输服务器设置维护状态</span><br><span class="line">Set-ServerComponentState $Computer -Component HubTransport -State Active -Requester Maintenance</span><br><span class="line"></span><br><span class="line"># 7. 重启Exchange传输服务</span><br><span class="line">Restart-Service MSExchangeTransport</span><br><span class="line"></span><br><span class="line"># 8. 查询所有服务器状态，所有组件必须为 “inactive” 状态 。（除了Monitoring 和 RecoveryActionsEnabled）</span><br><span class="line">Get-ServerComponentState $Computer | ft Component,State -Autosize</span><br></pre></td></tr></table></figure>

<h2 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h2><p>一、 IIS导致的故障</p>
<p>解决方法：</p>
<ol>
<li>verify you have several gigs free disk space on C drive of the server being upgraded</li>
<li>Stop the IISADMIN service and World Wide Web Services</li>
<li>Make sure the account your using to run the installer is member of schema admins, domain admins and exchange organization management</li>
<li>Run the upgrade again, but this time, right click the install file and click ‘run as administrator’</li>
</ol>
<p>参考：<a href="https://enterpriseit.co/microsoft-exchange/2013/error-cu-upgrade-system-management-automation-remoteexception/" target="_blank" rel="noopener">https://enterpriseit.co/microsoft-exchange/2013/error-cu-upgrade-system-management-automation-remoteexception/</a></p>
<p>二、 安装CU23出现错误 “ Setup can’t continue with the upgrade because the monad(7688) …mscorsvw (14664) has open files. Close the process, and then restart Setup. For more information, visit: <a href="http://technet.microsoft.com/library(EXCHG.150)/ms.exch.setupreadiness.ProcessNeedsToBeClosedOnUpgrade.aspx" target="_blank" rel="noopener">http://technet.microsoft.com/library(EXCHG.150)/ms.exch.setupreadiness.ProcessNeedsToBeClosedOnUpgrade.aspx</a> ”</p>
<ul>
<li><p>关于 mscorsvw（14664） 是一个 .net 相关的进程，可能net4.7.2没有安装成功。</p>
</li>
<li><p>参考：<a href="https://www.concurrency.com/blog/w/exchange-2013-cu-installation-setup-can-t-continue" target="_blank" rel="noopener">https://www.concurrency.com/blog/w/exchange-2013-cu-installation-setup-can-t-continue</a></p>
</li>
<li><p>关于monad（7688）是一个powershell的进程，但这是跟NetBackup备份服务相关的进程冲突导致的，需要关闭相关服务。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/03/07/%E6%9F%A5%E8%AF%A2%E5%B7%B2%E5%AE%89%E8%A3%85%E7%9A%84dotNet%E7%89%88%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/07/%E6%9F%A5%E8%AF%A2%E5%B7%B2%E5%AE%89%E8%A3%85%E7%9A%84dotNet%E7%89%88%E6%9C%AC/" itemprop="url">查询已安装的dotNet版本</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-07T22:55:26+08:00">
                2020-03-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/03/05/Ubuntu-18-04%E4%BF%AE%E6%94%B9%E7%BD%91%E5%8D%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/05/Ubuntu-18-04%E4%BF%AE%E6%94%B9%E7%BD%91%E5%8D%A1/" itemprop="url">Ubuntu 18.04修改网卡</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-05T23:27:09+08:00">
                2020-03-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="How-to-configure-static-ip"><a href="#How-to-configure-static-ip" class="headerlink" title="How to configure static ip"></a>How to configure static ip</h1><p>To configure a static IP address on your Ubuntu 18.04 server you need to modify a relevant netplan network configuration file within /etc/netplan/ directory.</p>
<p>For example you might find there a default netplan configuration file called 01-netcfg.yaml or 50-cloud-init.yaml with a following content instructing the networkd deamon to configure your network interface via DHCP:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This file describes the network interfaces available on your system</span></span><br><span class="line"><span class="comment"># For more information, see netplan(5).</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">renderer:</span> <span class="string">networkd</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">    <span class="attr">enp0s3:</span></span><br><span class="line">      <span class="attr">dhcp4:</span> <span class="literal">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This file describes the network interfaces available on your system</span></span><br><span class="line"><span class="comment"># For more information, see netplan(5).</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">renderer:</span> <span class="string">networkd</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">    <span class="attr">enp0s3:</span></span><br><span class="line">     <span class="attr">dhcp4:</span> <span class="literal">no</span></span><br><span class="line">     <span class="attr">addresses:</span> <span class="string">[192.168.1.222/24]</span></span><br><span class="line">     <span class="attr">gateway4:</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">     <span class="attr">nameservers:</span></span><br><span class="line">       <span class="attr">addresses:</span> <span class="string">[8.8.8.8,8.8.4.4]</span></span><br></pre></td></tr></table></figure>

<h1 id="修改完后"><a href="#修改完后" class="headerlink" title="修改完后"></a>修改完后</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netplan apply</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://linuxconfig.org/how-to-configure-static-ip-address-on-ubuntu-18-04-bionic-beaver-linux" target="_blank" rel="noopener">https://linuxconfig.org/how-to-configure-static-ip-address-on-ubuntu-18-04-bionic-beaver-linux</a></p>
<p><a href="https://www.jianshu.com/p/1378e6abd94d" target="_blank" rel="noopener">https://www.jianshu.com/p/1378e6abd94d</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/03/01/Exchange-Management-Shell-%E6%8C%87%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/01/Exchange-Management-Shell-%E6%8C%87%E4%BB%A4/" itemprop="url">Exchange Management Shell 指令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-01T23:21:53+08:00">
                2020-03-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Move-ActiveMailboxDatabase"><a href="#Move-ActiveMailboxDatabase" class="headerlink" title="Move-ActiveMailboxDatabase"></a>Move-ActiveMailboxDatabase</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Example 1:</span><br><span class="line">Move-ActiveMailboxDatabase -Server MBX1</span><br><span class="line"></span><br><span class="line"># This example performs a server switchover for the Mailbox server MBX1. All active mailbox database copies on MBX1 will be activated on one or more other Mailbox servers with healthy copies of the active databases on MBX1.</span><br></pre></td></tr></table></figure>

<p>参考： <a href="https://docs.microsoft.com/en-us/powershell/module/exchange/database-availability-groups/move-activemailboxdatabase?view=exchange-ps" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/powershell/module/exchange/database-availability-groups/move-activemailboxdatabase?view=exchange-ps</a></p>
<h1 id="Get-MailboxDatabaseCopyStatus"><a href="#Get-MailboxDatabaseCopyStatus" class="headerlink" title="Get-MailboxDatabaseCopyStatus"></a>Get-MailboxDatabaseCopyStatus</h1><p>Use the Get-MailboxDatabaseCopyStatus cmdlet to view health and status information about one or more mailbox database copies.</p>
<p>参考：<a href="https://docs.microsoft.com/en-us/powershell/module/exchange/database-availability-groups/get-mailboxdatabasecopystatus?view=exchange-ps" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/powershell/module/exchange/database-availability-groups/get-mailboxdatabasecopystatus?view=exchange-ps</a></p>
<h1 id="Test-ServerHealth"><a href="#Test-ServerHealth" class="headerlink" title="Test-ServerHealth"></a>Test-ServerHealth</h1><p>Use the Test-ServiceHealth cmdlet to test whether all the Microsoft Windows services that Exchange requires on a server have started. The Test-ServiceHealth cmdlet returns an error for any service required by a configured role when the service is set to start automatically and isn’t currently running.</p>
<p>参考：<a href="https://docs.microsoft.com/en-us/powershell/module/exchange/server-health-and-performance/test-servicehealth" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/powershell/module/exchange/server-health-and-performance/test-servicehealth</a></p>
<h1 id="Test-MAPIConnectivity"><a href="#Test-MAPIConnectivity" class="headerlink" title="Test-MAPIConnectivity"></a>Test-MAPIConnectivity</h1><p>Use the Test-MapiConnectivity cmdlet to verify server functionality by logging on to the mailbox that you specify. If you don’t specify a mailbox, the cmdlet logs on to the SystemMailbox on the database that you specify.</p>
<p>参考：<a href="https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/test-mapiconnectivity?view=exchange-ps" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/test-mapiconnectivity?view=exchange-ps</a></p>
<h1 id="Get-ExchangeServer"><a href="#Get-ExchangeServer" class="headerlink" title="Get-ExchangeServer"></a>Get-ExchangeServer</h1><p>Use the Get-ExchangeServer cmdlet to view the properties of Exchange servers.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Get-ExchangeServer | ft Name,Edition,AdminDisplayVersion</span><br><span class="line"></span><br><span class="line"># Exchange CU23 (Cumulative Updates 23),Version is 15.0.0.1497.002</span><br><span class="line"># https:&#x2F;&#x2F;www.microsoft.com&#x2F;en-us&#x2F;download&#x2F;details.aspx?id&#x3D;58392</span><br><span class="line"># Require： DotNet4.7.2</span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://docs.microsoft.com/en-us/powershell/module/exchange/organization/Get-ExchangeServer" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/powershell/module/exchange/organization/Get-ExchangeServer</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/02/25/Ubuntu%E5%9B%A0%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%E9%97%AE%E9%A2%98%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/25/Ubuntu%E5%9B%A0%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%E9%97%AE%E9%A2%98%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E7%B3%BB%E7%BB%9F/" itemprop="url">Ubuntu因显卡驱动问题无法进入系统</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-02-25T15:42:11+08:00">
                2020-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="故障现象"><a href="#故障现象" class="headerlink" title="故障现象"></a>故障现象</h1><p>无法进入图形界面，重复输入密码。<br>进入命令行界面，查看xsession-error日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">name of display: :0</span><br><span class="line">X Error of failed request:  BadValue (integer parameter out of range for operation)</span><br><span class="line">Major opcode of failed request:  154 (GLX)</span><br><span class="line">Minor opcode of failed request:  24 (X_GLXCreateNewContext)</span><br><span class="line">Value in failed request:  0x0</span><br><span class="line">Serial number of failed request:  30</span><br><span class="line">Current serial number in output stream:  31</span><br><span class="line"></span><br><span class="line">openConnection:connect:No such file or directory</span><br><span class="line">cannot connect to britty at :0</span><br></pre></td></tr></table></figure>

<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>#</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://github.com/r0manj/2020/02/25/Ubuntu%E9%85%8D%E7%BD%AEVNC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rohman.Zhu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="R0hman の 实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/25/Ubuntu%E9%85%8D%E7%BD%AEVNC/" itemprop="url">Ubuntu配置VNC</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-02-25T15:20:13+08:00">
                2020-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/">BACK</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/3/">NEXT</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Rohman.Zhu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">195</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">65</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Rohman.Zhu</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count"></span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
